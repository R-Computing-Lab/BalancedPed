write.table(df_results, "~/R-Project/BalancedPed/Graphs/PowerTable.csv", quote = FALSE, sep = ",")
### generate 11 fixed ped and save them into a r data file ot used for simulation
#source("~/R-Project/BalancedPed/evenInsert.R")
#source("~/R-Project/BalancedPed/famSizeCal.R")
#source("~/R-Project/BalancedPed/SimPed.R")
set.seed(7)
ped1 <- SimPed(2,4,.5,2/3)
ped2 <- SimPed(3,4,.5,2/3)
ped3 <- SimPed(4,4,.5,2/3)
ped4 <- SimPed(2,5,.5,2/3)
ped5 <- SimPed(3,5,.5,2/3)
ped6 <- SimPed(3,5,.6,2/3)
ped7 <- SimPed(3,6,.5,2/3)
ped8 <- SimPed(3,8,.5,2/3)
ped9 <- SimPed(4,4,.5,.8)
ped10 <- SimPed(8,4,.5,2/3)
ped11 <- SimPed(6,6,.5,2/3)
save.image("~/R-Project/BalancedPed/FixedPed.RData")
### generate 11 fixed ped and save them into a r data file ot used for simulation
source("~/R-Project/BalancedPed/evenInsert.R")
source("~/R-Project/BalancedPed/famSizeCal.R")
source("~/R-Project/BalancedPed/SimPed.R")
set.seed(7)
ped1 <- SimPed(2,4,.5,2/3)
ped2 <- SimPed(3,4,.5,2/3)
ped3 <- SimPed(4,4,.5,2/3)
ped4 <- SimPed(2,5,.5,2/3)
ped5 <- SimPed(3,5,.5,2/3)
ped6 <- SimPed(3,5,.6,2/3)
ped7 <- SimPed(3,6,.5,2/3)
ped8 <- SimPed(3,8,.5,2/3)
ped9 <- SimPed(4,4,.5,.8)
ped10 <- SimPed(8,4,.5,2/3)
ped11 <- SimPed(6,6,.5,2/3)
save.image("~/R-Project/BalancedPed/FixedPed.RData")
### this is a script to generate power plots for the simulation results
run_protected_loop <- function(){
for (p in 1: 8){
for (c in 1: 11){
dir <- paste0("~/R-Project/BalancedPed/Simulations/p",p,"/p",p, "c",c)
if (dir.exists(dir)){
cat("starttime:", as.character(Sys.time()))
cat("running", dir)
setwd(dir)
source(paste0("p",p,"c",c,".R"))
cat("finished at" , as.character(Sys.time()))
}else{
next
}
}
}
}
## Run all the scripts
run_protected_loop()
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c( "#E41A1C", "#332288", "#E69F00", "#DDCC77", "#377EB8",  "#4DAF4A", "#117A65", "#56B4E9", "#A6CE39", "#A9A9A9","#88CCEE", "#CC6677",  "#AA4499",   "#999933", "#882255", "#984EA3")
### create a new enviroment for one condition
env_p2c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p2/p2c5/modelSmr.Rdata", envir = env_p2c5)
#load("~/BalancedPed/Simulations/p2/p2c5/modelSmr.Rdata", envir = env_p2c5)
meanDiffLL_mtam_p2c5 <- env_p2c5$smr2$Minus2LogLikelihood - env_p2c5$smr1$Minus2LogLikelihood
PN <- ncol(env_p2c5[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p2c5[["smr1"]][["dataSummary"]])
lamdaUnit_p2c5 <- meanDiffLL_mtam_p2c5/PN
SSize_p2c5 <- 1: 10000
LamdaVec_p2c5 <- lamdaUnit_p2c5*SSize_p2c5
powVec_p2c5 <- as.numeric(lapply(LamdaVec_p2c5,powerCal, df = 2))
df_p2c5 <- data.frame(Nped = SSize_p2c5,
power = powVec_p2c5,
Combination = rep("power1", 10000))
### create a new enviroment for one condition
env_p5c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p5/p5c5/modelSmr.Rdata", envir = env_p5c5)
#load("~/BalancedPed/Simulations/p5/p5c5/modelSmr.Rdata", envir = env_p5c5)
meanDiffLL_mtam_p5c5 <- env_p5c5$smr2$Minus2LogLikelihood - env_p5c5$smr1$Minus2LogLikelihood
PN <- ncol(env_p5c5[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p5c5[["smr1"]][["dataSummary"]])
lamdaUnit_p5c5 <- meanDiffLL_mtam_p5c5/PN
SSize_p5c5 <- 1: 10000
LamdaVec_p5c5 <- lamdaUnit_p5c5*SSize_p5c5
powVec_p5c5 <- as.numeric(lapply(LamdaVec_p5c5,powerCal, df = 2))
df_p5c5 <- data.frame(Nped = SSize_p5c5,
power = powVec_p5c5,
Combination = rep("power2", 10000))
### create a new enviroment for one condition
env_p8c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p8/p8c5/modelSmr.Rdata", envir = env_p8c5)
#load("~/BalancedPed/Simulations/p8/p8c5/modelSmr.Rdata", envir = env_p8c5)
meanDiffLL_mtam_p8c5 <- env_p8c5$smr2$Minus2LogLikelihood - env_p8c5$smr1$Minus2LogLikelihood
PN <- ncol(env_p8c5[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p8c5[["smr1"]][["dataSummary"]])
lamdaUnit_p8c5 <- meanDiffLL_mtam_p8c5/PN
SSize_p8c5 <- 1: 10000
LamdaVec_p8c5 <- lamdaUnit_p8c5*SSize_p8c5
powVec_p8c5 <- as.numeric(lapply(LamdaVec_p8c5,powerCal, df = 2))
df_p8c5 <- data.frame(Nped = SSize_p8c5,
power = powVec_p8c5,
Combination = rep("power3", 10000))
### create a data frame for graphs
df_c5 <- rbind(df_p2c5, df_p5c5, df_p8c5)
df_c5$Combination <- as.factor(df_c5$Combination)
g1 <-ggplot(data = df_c5)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:3],
name="Pedigree Structures",
breaks=c("power1", "power2", "power3"),
labels=c("k = 3, s = 4, m = 29",
"k = 3, s = 5, m = 61",
"k = 3, s = 8, m = 509")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Individuals")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/graph_c5p258.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c( "#E41A1C", "#332288", "#E69F00", "#DDCC77", "#377EB8",  "#4DAF4A", "#117A65", "#56B4E9", "#A6CE39", "#A9A9A9","#88CCEE", "#CC6677",  "#AA4499",   "#999933", "#882255", "#984EA3")
### create a new enviroment for one condition
env_p2c6 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p2/p2c6/modelSmr.Rdata", envir = env_p2c6)
#load("~/BalancedPed/Simulations/p2/p2c6/modelSmr.Rdata", envir = env_p2c6)
meanDiffLL_mtam_p2c6 <- env_p2c6$smr2$Minus2LogLikelihood - env_p2c6$smr1$Minus2LogLikelihood
PN <- ncol(env_p2c6[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p2c6[["smr1"]][["dataSummary"]])
lamdaUnit_p2c6 <- meanDiffLL_mtam_p2c6/PN
SSize_p2c6 <- 1: 30000
LamdaVec_p2c6 <- lamdaUnit_p2c6*SSize_p2c6
powVec_p2c6 <- as.numeric(lapply(LamdaVec_p2c6,powerCal, df = 2))
df_p2c6 <- data.frame(Nped = SSize_p2c6,
power = powVec_p2c6,
Combination = rep("power1", 30000))
### create a new enviroment for one condition
env_p5c6 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p5/p5c6/modelSmr.Rdata", envir = env_p5c6)
#load("~/BalancedPed/Simulations/p5/p5c6/modelSmr.Rdata", envir = env_p5c6)
meanDiffLL_mtam_p5c6 <- env_p5c6$smr2$Minus2LogLikelihood - env_p5c6$smr1$Minus2LogLikelihood
PN <- ncol(env_p5c6[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p5c6[["smr1"]][["dataSummary"]])
lamdaUnit_p5c6 <- meanDiffLL_mtam_p5c6/PN
SSize_p5c6 <- 1: 30000
LamdaVec_p5c6 <- lamdaUnit_p5c6*SSize_p5c6
powVec_p5c6 <- as.numeric(lapply(LamdaVec_p5c6,powerCal, df = 2))
df_p5c6 <- data.frame(Nped = SSize_p5c6,
power = powVec_p5c6,
Combination = rep("power2", 30000))
### create a new enviroment for one condition
env_p8c6 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p8/p8c6/modelSmr.Rdata", envir = env_p8c6)
#load("~/BalancedPed/Simulations/p8/p8c6/modelSmr.Rdata", envir = env_p8c6)
meanDiffLL_mtam_p8c6 <- env_p8c6$smr2$Minus2LogLikelihood - env_p8c6$smr1$Minus2LogLikelihood
PN <- ncol(env_p8c6[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p8c6[["smr1"]][["dataSummary"]])
lamdaUnit_p8c6 <- meanDiffLL_mtam_p8c6/PN
SSize_p8c6 <- 1: 30000
LamdaVec_p8c6 <- lamdaUnit_p8c6*SSize_p8c6
powVec_p8c6 <- as.numeric(lapply(LamdaVec_p8c6,powerCal, df = 2))
df_p8c6 <- data.frame(Nped = SSize_p8c6,
power = powVec_p8c6,
Combination = rep("power3", 30000))
### create a data frame for graphs
df_c6 <- rbind(df_p2c6, df_p5c6, df_p8c6)
df_c6$Combination <- as.factor(df_c6$Combination)
g1 <-ggplot(data = df_c6)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:3],
name="Pedigree Structures",
breaks=c("power1", "power2", "power3"),
labels=c("k = 3, s = 4, m = 29",
"k = 3, s = 5, m = 61",
"k = 3, s = 8, m = 509")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Individuals")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/graph_c6p258.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c("#377EB8", "#E69F00", "#4DAF4A", "#117A65", "#56B4E9", "#A6CE39", "#A9A9A9", "#E41A1C", "#88CCEE", "#CC6677", "#DDCC77", "#AA4499", "#332288",  "#999933", "#882255", "#984EA3")
### create a new enviroment for one condition
env_p2c9 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p2/p2c9/modelSmr.Rdata", envir = env_p2c9)
#load("~/BalancedPed/Simulations/p2/p2c9/modelSmr.Rdata", envir = env_p2c9)
meanDiffLL_mtam_p2c9 <- env_p2c9$smr2$Minus2LogLikelihood - env_p2c9$smr1$Minus2LogLikelihood
PN <- ncol(env_p2c9[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p2c9[["smr1"]][["dataSummary"]])
lamdaUnit_p2c9 <- meanDiffLL_mtam_p2c9/PN
SSize_p2c9 <- 1: 50000
LamdaVec_p2c9 <- lamdaUnit_p2c9*SSize_p2c9
powVec_p2c9 <- as.numeric(lapply(LamdaVec_p2c9,powerCal, df = 2))
df_p2c9 <- data.frame(Nped = SSize_p2c9,
power = powVec_p2c9,
Combination = rep("power1", 50000))
### create a new enviroment for one condition
env_p5c9 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p5/p5c9/modelSmr.Rdata", envir = env_p5c9)
#load("~/BalancedPed/Simulations/p5/p5c9/modelSmr.Rdata", envir = env_p5c9)
meanDiffLL_mtam_p5c9 <- env_p5c9$smr2$Minus2LogLikelihood - env_p5c9$smr1$Minus2LogLikelihood
PN <- ncol(env_p5c9[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p5c9[["smr1"]][["dataSummary"]])
lamdaUnit_p5c9 <- meanDiffLL_mtam_p5c9/PN
SSize_p5c9 <- 1: 50000
LamdaVec_p5c9 <- lamdaUnit_p5c9*SSize_p5c9
powVec_p5c9 <- as.numeric(lapply(LamdaVec_p5c9,powerCal, df = 2))
df_p5c9 <- data.frame(Nped = SSize_p5c9,
power = powVec_p5c9,
Combination = rep("power2", 50000))
### create a new enviroment for one condition
env_p8c9 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p8/p8c9/modelSmr.Rdata", envir = env_p8c9)
#load("~/BalancedPed/Simulations/p8/p8c9/modelSmr.Rdata", envir = env_p8c9)
meanDiffLL_mtam_p8c9 <- env_p8c9$smr2$Minus2LogLikelihood - env_p8c9$smr1$Minus2LogLikelihood
PN <- ncol(env_p8c9[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p8c9[["smr1"]][["dataSummary"]])
lamdaUnit_p8c9 <- meanDiffLL_mtam_p8c9/PN
SSize_p8c9 <- 1: 50000
LamdaVec_p8c9 <- lamdaUnit_p8c9*SSize_p8c9
powVec_p8c9 <- as.numeric(lapply(LamdaVec_p8c9,powerCal, df = 2))
df_p8c9 <- data.frame(Nped = SSize_p8c9,
power = powVec_p8c9,
Combination = rep("power3", 50000))
### create a data frame for graphs
df_c9 <- rbind(df_p2c9, df_p5c9, df_p8c9)
df_c9$Combination <- as.factor(df_c9$Combination)
g1 <-ggplot(data = df_c9)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:3],
name="Variance Combinations",
breaks=c("power1", "power2", "power3"),
labels=c("k = 3, s = 4, m = 29",
"k = 3, s = 5, m = 61",
"k = 3, s = 8, m = 509")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/graph_c9p258.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
### a script to calculate the number of individuals for a power of .8 in all conditions.
vec_p <- paste("p", 1:11, sep = "")
vec_c <- paste("c", 1:11, sep = "")
df_results <- matrix(nrow = 11, ncol = 11)
colnames(df_results) <- vec_p
rownames(df_results) <- vec_c
lunit <- .00001
ssize <- 1:1000000
l_vec <- lunit*ssize
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
powVec <- as.numeric(lapply(l_vec,powerCal, df = 2))
tgt_lunit <- which.min(abs(powVec-.80))*lunit
for (p in 1: 11){
for (c in 1: 11){
dir <- paste0("~/R-Project/BalancedPed/Simulations/p",p,"/p",p, "c",c)
if (dir.exists(dir)){
#cat("starttime:", as.character(Sys.time()))
cat("\n","running", dir)
setwd(dir)
load("modelSmr.Rdata")
meanDiffLL_mtam <- smr2$Minus2LogLikelihood - smr1$Minus2LogLikelihood
PN <- ncol(smr1[["dataSummary"]][["fam1"]])*length(smr1[["dataSummary"]])
lamdaUnit <- meanDiffLL_mtam/PN
df_results[c,p] <- round(tgt_lunit/lamdaUnit)
#cat("finished at" , as.character(Sys.time()))
}else{
next
}
}
}
write.table(df_results, "~/R-Project/BalancedPed/Graphs/PowerTable.csv", quote = FALSE, sep = ",")
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c( "#E41A1C", "#332288", "#E69F00", "#117A65", "#DDCC77", "#377EB8",  "#4DAF4A",  "#56B4E9", "#A6CE39", "#A9A9A9","#88CCEE", "#Cc2677",  "#AA4499",   "#999933", "#882255", "#984EA3")
### create a new enviroment for one condition
env_p1c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p1/p1c2/modelSmr.Rdata", envir = env_p1c2)
#load("~/BalancedPed/Simulations/p1/p1c2/modelSmr.Rdata", envir = env_p1c2)
meanDiffLL_mtam_p1c2 <- env_p1c2$smr2$Minus2LogLikelihood - env_p1c2$smr1$Minus2LogLikelihood
PN <- ncol(env_p1c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p1c2[["smr1"]][["dataSummary"]])
lamdaUnit_p1c2 <- meanDiffLL_mtam_p1c2/PN
SSize_p1c2 <- 1: 10000
LamdaVec_p1c2 <- lamdaUnit_p1c2*SSize_p1c2
powVec_p1c2 <- as.numeric(lapply(LamdaVec_p1c2,powerCal, df = 2))
df_p1c2 <- data.frame(Nped = SSize_p1c2,
power = powVec_p1c2,
Combination = rep("power1", 10000))
### create a new enviroment for one condition
env_p2c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p2/p2c2/modelSmr.Rdata", envir = env_p2c2)
#load("~/BalancedPed/Simulations/p2/p2c2/modelSmr.Rdata", envir = env_p2c2)
meanDiffLL_mtam_p2c2 <- env_p2c2$smr2$Minus2LogLikelihood - env_p2c2$smr1$Minus2LogLikelihood
PN <- ncol(env_p2c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p2c2[["smr1"]][["dataSummary"]])
lamdaUnit_p2c2 <- meanDiffLL_mtam_p2c2/PN
SSize_p2c2 <- 1: 10000
LamdaVec_p2c2 <- lamdaUnit_p2c2*SSize_p2c2
powVec_p2c2 <- as.numeric(lapply(LamdaVec_p2c2,powerCal, df = 2))
df_p2c2 <- data.frame(Nped = SSize_p2c2,
power = powVec_p2c2,
Combination = rep("power2", 10000))
### create a new enviroment for one condition
env_p3c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p3/p3c2/modelSmr.Rdata", envir = env_p3c2)
#load("~/BalancedPed/Simulations/p3/p3c2/modelSmr.Rdata", envir = env_p3c2)
meanDiffLL_mtam_p3c2 <- env_p3c2$smr2$Minus2LogLikelihood - env_p3c2$smr1$Minus2LogLikelihood
PN <- ncol(env_p3c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p3c2[["smr1"]][["dataSummary"]])
lamdaUnit_p3c2 <- meanDiffLL_mtam_p3c2/PN
SSize_p3c2 <- 1: 10000
LamdaVec_p3c2 <- lamdaUnit_p3c2*SSize_p3c2
powVec_p3c2 <- as.numeric(lapply(LamdaVec_p3c2,powerCal, df = 2))
df_p3c2 <- data.frame(Nped = SSize_p3c2,
power = powVec_p3c2,
Combination = rep("power3", 10000))
# ### create a new enviroment for one condition
# env_p10c2 <- new.env()
# load("~/R-Project/BalancedPed/Simulations/p10/p10c2/modelSmr.Rdata", envir = env_p10c2)
# #load("~/BalancedPed/Simulations/p10/p10c2/modelSmr.Rdata", envir = env_p10c2)
#
# meanDiffLL_mtam_p10c2 <- env_p10c2$smr2$Minus2LogLikelihood - env_p10c2$smr1$Minus2LogLikelihood
# PN <- ncol(env_p10c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p10c2[["smr1"]][["dataSummary"]])
# lamdaUnit_p10c2 <- meanDiffLL_mtam_p10c2/PN
# SSize_p10c2 <- 1: 10000
# LamdaVec_p10c2 <- lamdaUnit_p10c2*SSize_p10c2
# powVec_p10c2 <- as.numeric(lapply(LamdaVec_p10c2,powerCal, df = 2))
#
# df_p10c2 <- data.frame(Nped = SSize_p10c2,
#                        power = powVec_p10c2,
#                        Combination = rep("power4", 10000))
### create a data frame for graphs
df_c2 <- rbind(df_p1c2, df_p2c2, df_p3c2)
df_c2$Combination <- as.factor(df_c2$Combination)
g1 <-ggplot(data = df_c2)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:3],
name="Pedigree Structures",
breaks=c("power1", "power2", "power3"),
labels=c("k = 2, s = 4, m = 15",
"k = 3, s = 4, m = 29",
"k = 4, s = 4, m = 56")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Individuals")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/graph_c2p12310.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c( "#E41A1C", "#332288", "#E69F00", "#117A65", "#DDCC77", "#377EB8",  "#4DAF4A",  "#56B4E9", "#A6CE39", "#A9A9A9","#88CCEE", "#Cc2677",  "#AA4499",   "#999933", "#882255", "#984EA3")
### create a new enviroment for one condition
env_p1c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p1/p1c2/modelSmr.Rdata", envir = env_p1c2)
#load("~/BalancedPed/Simulations/p1/p1c2/modelSmr.Rdata", envir = env_p1c2)
meanDiffLL_mtam_p1c2 <- env_p1c2$smr2$Minus2LogLikelihood - env_p1c2$smr1$Minus2LogLikelihood
PN <- ncol(env_p1c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p1c2[["smr1"]][["dataSummary"]])
lamdaUnit_p1c2 <- meanDiffLL_mtam_p1c2/PN
SSize_p1c2 <- 1: 10000
LamdaVec_p1c2 <- lamdaUnit_p1c2*SSize_p1c2
powVec_p1c2 <- as.numeric(lapply(LamdaVec_p1c2,powerCal, df = 2))
df_p1c2 <- data.frame(Nped = SSize_p1c2,
power = powVec_p1c2,
Combination = rep("power1", 10000))
### create a new enviroment for one condition
env_p2c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p2/p2c2/modelSmr.Rdata", envir = env_p2c2)
#load("~/BalancedPed/Simulations/p2/p2c2/modelSmr.Rdata", envir = env_p2c2)
meanDiffLL_mtam_p2c2 <- env_p2c2$smr2$Minus2LogLikelihood - env_p2c2$smr1$Minus2LogLikelihood
PN <- ncol(env_p2c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p2c2[["smr1"]][["dataSummary"]])
lamdaUnit_p2c2 <- meanDiffLL_mtam_p2c2/PN
SSize_p2c2 <- 1: 10000
LamdaVec_p2c2 <- lamdaUnit_p2c2*SSize_p2c2
powVec_p2c2 <- as.numeric(lapply(LamdaVec_p2c2,powerCal, df = 2))
df_p2c2 <- data.frame(Nped = SSize_p2c2,
power = powVec_p2c2,
Combination = rep("power2", 10000))
### create a new enviroment for one condition
env_p3c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p3/p3c2/modelSmr.Rdata", envir = env_p3c2)
#load("~/BalancedPed/Simulations/p3/p3c2/modelSmr.Rdata", envir = env_p3c2)
meanDiffLL_mtam_p3c2 <- env_p3c2$smr2$Minus2LogLikelihood - env_p3c2$smr1$Minus2LogLikelihood
PN <- ncol(env_p3c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p3c2[["smr1"]][["dataSummary"]])
lamdaUnit_p3c2 <- meanDiffLL_mtam_p3c2/PN
SSize_p3c2 <- 1: 10000
LamdaVec_p3c2 <- lamdaUnit_p3c2*SSize_p3c2
powVec_p3c2 <- as.numeric(lapply(LamdaVec_p3c2,powerCal, df = 2))
df_p3c2 <- data.frame(Nped = SSize_p3c2,
power = powVec_p3c2,
Combination = rep("power3", 10000))
# ### create a new enviroment for one condition
# env_p10c2 <- new.env()
# load("~/R-Project/BalancedPed/Simulations/p10/p10c2/modelSmr.Rdata", envir = env_p10c2)
# #load("~/BalancedPed/Simulations/p10/p10c2/modelSmr.Rdata", envir = env_p10c2)
#
# meanDiffLL_mtam_p10c2 <- env_p10c2$smr2$Minus2LogLikelihood - env_p10c2$smr1$Minus2LogLikelihood
# PN <- ncol(env_p10c2[["smr1"]][["dataSummary"]][["fam1"]])*length(env_p10c2[["smr1"]][["dataSummary"]])
# lamdaUnit_p10c2 <- meanDiffLL_mtam_p10c2/PN
# SSize_p10c2 <- 1: 10000
# LamdaVec_p10c2 <- lamdaUnit_p10c2*SSize_p10c2
# powVec_p10c2 <- as.numeric(lapply(LamdaVec_p10c2,powerCal, df = 2))
#
# df_p10c2 <- data.frame(Nped = SSize_p10c2,
#                        power = powVec_p10c2,
#                        Combination = rep("power4", 10000))
### create a data frame for graphs
df_c2 <- rbind(df_p1c2, df_p2c2, df_p3c2)
df_c2$Combination <- as.factor(df_c2$Combination)
g1 <-ggplot(data = df_c2)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:3],
name="Pedigree Structures",
breaks=c("power1", "power2", "power3"),
labels=c("k = 2, s = 4, m = 15",
"k = 3, s = 4, m = 29",
"k = 4, s = 4, m = 56")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Individuals")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/graph_c2p123.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
