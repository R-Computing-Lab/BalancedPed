meanDiffLL_mtam_p3c2 <- env_p3c2$smr2$Minus2LogLikelihood - env_p3c2$smr1$Minus2LogLikelihood
lamdaUnit_p3c2 <- meanDiffLL_mtam_p3c2/env_p3c2$smr1$numObs
SSize_p3c2 <- 1: num_ped
LamdaVec_p3c2 <- lamdaUnit_p3c2*SSize_p3c2
powVec_p3c2 <- as.numeric(lapply(LamdaVec_p3c2,powerCal, df = 2))
df_p3c2 <- data.frame(Nped = SSize_p3c2,
power = powVec_p3c2,
Combination = rep("power1", num_ped))
### create a new enviroment for one condition
env_p3c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p3/p3c5/modelSmr.Rdata", envir = env_p3c5)
meanDiffLL_mtam_p3c5 <- env_p3c5$smr2$Minus2LogLikelihood - env_p3c5$smr1$Minus2LogLikelihood
lamdaUnit_p3c5 <- meanDiffLL_mtam_p3c5/env_p3c5$smr1$numObs
SSize_p3c5 <- 1: num_ped
LamdaVec_p3c5 <- lamdaUnit_p3c5*SSize_p3c5
powVec_p3c5 <- as.numeric(lapply(LamdaVec_p3c5,powerCal, df = 2))
df_p3c5 <- data.frame(Nped = SSize_p3c5,
power = powVec_p3c5,
Combination = rep("power2", num_ped))
### create a new enviroment for one condition
env_p3c8 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p3/p3c8/modelSmr.Rdata", envir = env_p3c8)
meanDiffLL_mtam_p3c8 <- env_p3c8$smr2$Minus2LogLikelihood - env_p3c8$smr1$Minus2LogLikelihood
lamdaUnit_p3c8 <- meanDiffLL_mtam_p3c8/env_p3c8$smr1$numObs
SSize_p3c8 <- 1: num_ped
LamdaVec_p3c8 <- lamdaUnit_p3c8*SSize_p3c8
powVec_p3c8 <- as.numeric(lapply(LamdaVec_p3c8,powerCal, df = 2))
df_p3c8 <- data.frame(Nped = SSize_p3c8,
power = powVec_p3c8,
Combination = rep("power3", num_ped))
### create a new enviroment for one condition
env_p3c11 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p3/p3c11/modelSmr.Rdata", envir = env_p3c11)
meanDiffLL_mtam_p3c11 <- env_p3c11$smr2$Minus2LogLikelihood - env_p3c11$smr1$Minus2LogLikelihood
lamdaUnit_p3c11 <- meanDiffLL_mtam_p3c11/env_p3c11$smr1$numObs
SSize_p3c11 <- 1: num_ped
LamdaVec_p3c11 <- lamdaUnit_p3c11*SSize_p3c11
powVec_p3c11 <- as.numeric(lapply(LamdaVec_p3c11,powerCal, df = 2))
df_p3c11 <- data.frame(Nped = SSize_p3c11,
power = powVec_p3c11,
Combination = rep("power4", num_ped))
### create a data frame for graphs
df_p3 <- rbind(df_p3c2, df_p3c5, df_p3c8, df_p3c11)
df_p3$Combination <- as.factor(df_p3$Combination)
g1 <-ggplot(data = df_p3)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:4],
name="Variance Combinations",
breaks=c("power1", "power2", "power3","power4"),
labels=c("a\u00B2 = .6, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .2, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05, d\u00B2 = .1")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/Appendix/p3all.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
# script to plot power plots
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c("#377EB8", "#E69F00", "#4DAF4A", "#984EA3",  "#56B4E9", "#A6CE39", "#A9A9A9", "#E41A1C")
num_ped <- 180
### create a new enviroment for one condition
env_p4c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p4/p4c2/modelSmr.Rdata", envir = env_p4c2)
meanDiffLL_mtam_p4c2 <- env_p4c2$smr2$Minus2LogLikelihood - env_p4c2$smr1$Minus2LogLikelihood
lamdaUnit_p4c2 <- meanDiffLL_mtam_p4c2/env_p4c2$smr1$numObs
SSize_p4c2 <- 1: num_ped
LamdaVec_p4c2 <- lamdaUnit_p4c2*SSize_p4c2
powVec_p4c2 <- as.numeric(lapply(LamdaVec_p4c2,powerCal, df = 2))
df_p4c2 <- data.frame(Nped = SSize_p4c2,
power = powVec_p4c2,
Combination = rep("power1", num_ped))
### create a new enviroment for one condition
env_p4c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p4/p4c5/modelSmr.Rdata", envir = env_p4c5)
meanDiffLL_mtam_p4c5 <- env_p4c5$smr2$Minus2LogLikelihood - env_p4c5$smr1$Minus2LogLikelihood
lamdaUnit_p4c5 <- meanDiffLL_mtam_p4c5/env_p4c5$smr1$numObs
SSize_p4c5 <- 1: num_ped
LamdaVec_p4c5 <- lamdaUnit_p4c5*SSize_p4c5
powVec_p4c5 <- as.numeric(lapply(LamdaVec_p4c5,powerCal, df = 2))
df_p4c5 <- data.frame(Nped = SSize_p4c5,
power = powVec_p4c5,
Combination = rep("power2", num_ped))
### create a new enviroment for one condition
env_p4c8 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p4/p4c8/modelSmr.Rdata", envir = env_p4c8)
meanDiffLL_mtam_p4c8 <- env_p4c8$smr2$Minus2LogLikelihood - env_p4c8$smr1$Minus2LogLikelihood
lamdaUnit_p4c8 <- meanDiffLL_mtam_p4c8/env_p4c8$smr1$numObs
SSize_p4c8 <- 1: num_ped
LamdaVec_p4c8 <- lamdaUnit_p4c8*SSize_p4c8
powVec_p4c8 <- as.numeric(lapply(LamdaVec_p4c8,powerCal, df = 2))
df_p4c8 <- data.frame(Nped = SSize_p4c8,
power = powVec_p4c8,
Combination = rep("power3", num_ped))
### create a new enviroment for one condition
env_p4c11 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p4/p4c11/modelSmr.Rdata", envir = env_p4c11)
meanDiffLL_mtam_p4c11 <- env_p4c11$smr2$Minus2LogLikelihood - env_p4c11$smr1$Minus2LogLikelihood
lamdaUnit_p4c11 <- meanDiffLL_mtam_p4c11/env_p4c11$smr1$numObs
SSize_p4c11 <- 1: num_ped
LamdaVec_p4c11 <- lamdaUnit_p4c11*SSize_p4c11
powVec_p4c11 <- as.numeric(lapply(LamdaVec_p4c11,powerCal, df = 2))
df_p4c11 <- data.frame(Nped = SSize_p4c11,
power = powVec_p4c11,
Combination = rep("power4", num_ped))
### create a data frame for graphs
df_p4 <- rbind(df_p4c2, df_p4c5, df_p4c8, df_p4c11)
df_p4$Combination <- as.factor(df_p4$Combination)
g1 <-ggplot(data = df_p4)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:4],
name="Variance Combinations",
breaks=c("power1", "power2", "power3","power4"),
labels=c("a\u00B2 = .6, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .2, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05, d\u00B2 = .1")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/Appendix/p4all.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
# script to plot power plots
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c("#377EB8", "#E69F00", "#4DAF4A", "#984EA3",  "#56B4E9", "#A6CE39", "#A9A9A9", "#E41A1C")
num_ped <- 100
### create a new enviroment for one condition
env_p6c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p6/p6c2/modelSmr.Rdata", envir = env_p6c2)
meanDiffLL_mtam_p6c2 <- env_p6c2$smr2$Minus2LogLikelihood - env_p6c2$smr1$Minus2LogLikelihood
lamdaUnit_p6c2 <- meanDiffLL_mtam_p6c2/env_p6c2$smr1$numObs
SSize_p6c2 <- 1: num_ped
LamdaVec_p6c2 <- lamdaUnit_p6c2*SSize_p6c2
powVec_p6c2 <- as.numeric(lapply(LamdaVec_p6c2,powerCal, df = 2))
df_p6c2 <- data.frame(Nped = SSize_p6c2,
power = powVec_p6c2,
Combination = rep("power1", num_ped))
### create a new enviroment for one condition
env_p6c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p6/p6c5/modelSmr.Rdata", envir = env_p6c5)
meanDiffLL_mtam_p6c5 <- env_p6c5$smr2$Minus2LogLikelihood - env_p6c5$smr1$Minus2LogLikelihood
lamdaUnit_p6c5 <- meanDiffLL_mtam_p6c5/env_p6c5$smr1$numObs
SSize_p6c5 <- 1: num_ped
LamdaVec_p6c5 <- lamdaUnit_p6c5*SSize_p6c5
powVec_p6c5 <- as.numeric(lapply(LamdaVec_p6c5,powerCal, df = 2))
df_p6c5 <- data.frame(Nped = SSize_p6c5,
power = powVec_p6c5,
Combination = rep("power2", num_ped))
### create a new enviroment for one condition
env_p6c8 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p6/p6c8/modelSmr.Rdata", envir = env_p6c8)
meanDiffLL_mtam_p6c8 <- env_p6c8$smr2$Minus2LogLikelihood - env_p6c8$smr1$Minus2LogLikelihood
lamdaUnit_p6c8 <- meanDiffLL_mtam_p6c8/env_p6c8$smr1$numObs
SSize_p6c8 <- 1: num_ped
LamdaVec_p6c8 <- lamdaUnit_p6c8*SSize_p6c8
powVec_p6c8 <- as.numeric(lapply(LamdaVec_p6c8,powerCal, df = 2))
df_p6c8 <- data.frame(Nped = SSize_p6c8,
power = powVec_p6c8,
Combination = rep("power3", num_ped))
### create a new enviroment for one condition
env_p6c11 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p6/p6c11/modelSmr.Rdata", envir = env_p6c11)
meanDiffLL_mtam_p6c11 <- env_p6c11$smr2$Minus2LogLikelihood - env_p6c11$smr1$Minus2LogLikelihood
lamdaUnit_p6c11 <- meanDiffLL_mtam_p6c11/env_p6c11$smr1$numObs
SSize_p6c11 <- 1: num_ped
LamdaVec_p6c11 <- lamdaUnit_p6c11*SSize_p6c11
powVec_p6c11 <- as.numeric(lapply(LamdaVec_p6c11,powerCal, df = 2))
df_p6c11 <- data.frame(Nped = SSize_p6c11,
power = powVec_p6c11,
Combination = rep("power4", num_ped))
### create a data frame for graphs
df_p6 <- rbind(df_p6c2, df_p6c5, df_p6c8, df_p6c11)
df_p6$Combination <- as.factor(df_p6$Combination)
g1 <-ggplot(data = df_p6)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:4],
name="Variance Combinations",
breaks=c("power1", "power2", "power3","power4"),
labels=c("a\u00B2 = .6, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .2, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05, d\u00B2 = .1")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/Appendix/p6all.png.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
# script to plot power plots
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c("#377EB8", "#E69F00", "#4DAF4A", "#984EA3",  "#56B4E9", "#A6CE39", "#A9A9A9", "#E41A1C")
num_ped <- 100
### create a new enviroment for one condition
env_p7c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p7/p7c2/modelSmr.Rdata", envir = env_p7c2)
meanDiffLL_mtam_p7c2 <- env_p7c2$smr2$Minus2LogLikelihood - env_p7c2$smr1$Minus2LogLikelihood
lamdaUnit_p7c2 <- meanDiffLL_mtam_p7c2/env_p7c2$smr1$numObs
SSize_p7c2 <- 1: num_ped
LamdaVec_p7c2 <- lamdaUnit_p7c2*SSize_p7c2
powVec_p7c2 <- as.numeric(lapply(LamdaVec_p7c2,powerCal, df = 2))
df_p7c2 <- data.frame(Nped = SSize_p7c2,
power = powVec_p7c2,
Combination = rep("power1", num_ped))
### create a new enviroment for one condition
env_p7c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p7/p7c5/modelSmr.Rdata", envir = env_p7c5)
meanDiffLL_mtam_p7c5 <- env_p7c5$smr2$Minus2LogLikelihood - env_p7c5$smr1$Minus2LogLikelihood
lamdaUnit_p7c5 <- meanDiffLL_mtam_p7c5/env_p7c5$smr1$numObs
SSize_p7c5 <- 1: num_ped
LamdaVec_p7c5 <- lamdaUnit_p7c5*SSize_p7c5
powVec_p7c5 <- as.numeric(lapply(LamdaVec_p7c5,powerCal, df = 2))
df_p7c5 <- data.frame(Nped = SSize_p7c5,
power = powVec_p7c5,
Combination = rep("power2", num_ped))
### create a new enviroment for one condition
env_p7c8 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p7/p7c8/modelSmr.Rdata", envir = env_p7c8)
meanDiffLL_mtam_p7c8 <- env_p7c8$smr2$Minus2LogLikelihood - env_p7c8$smr1$Minus2LogLikelihood
lamdaUnit_p7c8 <- meanDiffLL_mtam_p7c8/env_p7c8$smr1$numObs
SSize_p7c8 <- 1: num_ped
LamdaVec_p7c8 <- lamdaUnit_p7c8*SSize_p7c8
powVec_p7c8 <- as.numeric(lapply(LamdaVec_p7c8,powerCal, df = 2))
df_p7c8 <- data.frame(Nped = SSize_p7c8,
power = powVec_p7c8,
Combination = rep("power3", num_ped))
### create a new enviroment for one condition
env_p7c11 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p7/p7c11/modelSmr.Rdata", envir = env_p7c11)
meanDiffLL_mtam_p7c11 <- env_p7c11$smr2$Minus2LogLikelihood - env_p7c11$smr1$Minus2LogLikelihood
lamdaUnit_p7c11 <- meanDiffLL_mtam_p7c11/env_p7c11$smr1$numObs
SSize_p7c11 <- 1: num_ped
LamdaVec_p7c11 <- lamdaUnit_p7c11*SSize_p7c11
powVec_p7c11 <- as.numeric(lapply(LamdaVec_p7c11,powerCal, df = 2))
df_p7c11 <- data.frame(Nped = SSize_p7c11,
power = powVec_p7c11,
Combination = rep("power4", num_ped))
### create a data frame for graphs
df_p7 <- rbind(df_p7c2, df_p7c5, df_p7c8, df_p7c11)
df_p7$Combination <- as.factor(df_p7$Combination)
g1 <-ggplot(data = df_p7)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:4],
name="Variance Combinations",
breaks=c("power1", "power2", "power3","power4"),
labels=c("a\u00B2 = .6, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .2, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05, d\u00B2 = .1")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/Appendix/p7all.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
# script to plot power plots
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c("#377EB8", "#E69F00", "#4DAF4A", "#984EA3",  "#56B4E9", "#A6CE39", "#A9A9A9", "#E41A1C")
num_ped <- 100
### create a new enviroment for one condition
env_p9c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c2/modelSmr.Rdata", envir = env_p9c2)
meanDiffLL_mtam_p9c2 <- env_p9c2$smr2$Minus2LogLikelihood - env_p9c2$smr1$Minus2LogLikelihood
lamdaUnit_p9c2 <- meanDiffLL_mtam_p9c2/env_p9c2$smr1$numObs
SSize_p9c2 <- 1: num_ped
LamdaVec_p9c2 <- lamdaUnit_p9c2*SSize_p9c2
powVec_p9c2 <- as.numeric(lapply(LamdaVec_p9c2,powerCal, df = 2))
df_p9c2 <- data.frame(Nped = SSize_p9c2,
power = powVec_p9c2,
Combination = rep("power1", num_ped))
### create a new enviroment for one condition
env_p9c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c5/modelSmr.Rdata", envir = env_p9c5)
meanDiffLL_mtam_p9c5 <- env_p9c5$smr2$Minus2LogLikelihood - env_p9c5$smr1$Minus2LogLikelihood
lamdaUnit_p9c5 <- meanDiffLL_mtam_p9c5/env_p9c5$smr1$numObs
SSize_p9c5 <- 1: num_ped
LamdaVec_p9c5 <- lamdaUnit_p9c5*SSize_p9c5
powVec_p9c5 <- as.numeric(lapply(LamdaVec_p9c5,powerCal, df = 2))
df_p9c5 <- data.frame(Nped = SSize_p9c5,
power = powVec_p9c5,
Combination = rep("power2", num_ped))
### create a new enviroment for one condition
env_p9c8 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c8/modelSmr.Rdata", envir = env_p9c8)
meanDiffLL_mtam_p9c8 <- env_p9c8$smr2$Minus2LogLikelihood - env_p9c8$smr1$Minus2LogLikelihood
lamdaUnit_p9c8 <- meanDiffLL_mtam_p9c8/env_p9c8$smr1$numObs
SSize_p9c8 <- 1: num_ped
LamdaVec_p9c8 <- lamdaUnit_p9c8*SSize_p9c8
powVec_p9c8 <- as.numeric(lapply(LamdaVec_p9c8,powerCal, df = 2))
df_p9c8 <- data.frame(Nped = SSize_p9c8,
power = powVec_p9c8,
Combination = rep("power3", num_ped))
### create a new enviroment for one condition
env_p9c11 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c11/modelSmr.Rdata", envir = env_p9c11)
meanDiffLL_mtam_p9c11 <- env_p9c11$smr2$Minus2LogLikelihood - env_p9c11$smr1$Minus2LogLikelihood
lamdaUnit_p9c11 <- meanDiffLL_mtam_p9c11/env_p9c11$smr1$numObs
SSize_p9c11 <- 1: num_ped
LamdaVec_p9c11 <- lamdaUnit_p9c11*SSize_p9c11
powVec_p9c11 <- as.numeric(lapply(LamdaVec_p9c11,powerCal, df = 2))
df_p9c11 <- data.frame(Nped = SSize_p9c11,
power = powVec_p9c11,
Combination = rep("power4", num_ped))
### create a data frame for graphs
df_p9 <- rbind(df_p9c2, df_p9c5, df_p9c8, df_p9c11)
df_p9$Combination <- as.factor(df_p9$Combination)
g1 <-ggplot(data = df_p9)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:4],
name="Variance Combinations",
breaks=c("power1", "power2", "power3","power4"),
labels=c("a\u00B2 = .6, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .2, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05, d\u00B2 = .1")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/Appendix/p9all.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
# script to plot power plots
library(ggplot2)
powerCal <- function(lamda,df){
1- pchisq(qchisq(1-.05, df), df, lamda)
}
my_palette <- c("#377EB8", "#E69F00", "#4DAF4A", "#984EA3",  "#56B4E9", "#A6CE39", "#A9A9A9", "#E41A1C")
num_ped <- 100
### create a new enviroment for one condition
env_p9c2 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c2/modelSmr.Rdata", envir = env_p9c2)
meanDiffLL_mtam_p9c2 <- env_p9c2$smr2$Minus2LogLikelihood - env_p9c2$smr1$Minus2LogLikelihood
lamdaUnit_p9c2 <- meanDiffLL_mtam_p9c2/env_p9c2$smr1$numObs
SSize_p9c2 <- 1: num_ped
LamdaVec_p9c2 <- lamdaUnit_p9c2*SSize_p9c2
powVec_p9c2 <- as.numeric(lapply(LamdaVec_p9c2,powerCal, df = 2))
df_p9c2 <- data.frame(Nped = SSize_p9c2,
power = powVec_p9c2,
Combination = rep("power1", num_ped))
### create a new enviroment for one condition
env_p9c5 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c5/modelSmr.Rdata", envir = env_p9c5)
meanDiffLL_mtam_p9c5 <- env_p9c5$smr2$Minus2LogLikelihood - env_p9c5$smr1$Minus2LogLikelihood
lamdaUnit_p9c5 <- meanDiffLL_mtam_p9c5/env_p9c5$smr1$numObs
SSize_p9c5 <- 1: num_ped
LamdaVec_p9c5 <- lamdaUnit_p9c5*SSize_p9c5
powVec_p9c5 <- as.numeric(lapply(LamdaVec_p9c5,powerCal, df = 2))
df_p9c5 <- data.frame(Nped = SSize_p9c5,
power = powVec_p9c5,
Combination = rep("power2", num_ped))
### create a new enviroment for one condition
env_p9c8 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c8/modelSmr.Rdata", envir = env_p9c8)
meanDiffLL_mtam_p9c8 <- env_p9c8$smr2$Minus2LogLikelihood - env_p9c8$smr1$Minus2LogLikelihood
lamdaUnit_p9c8 <- meanDiffLL_mtam_p9c8/env_p9c8$smr1$numObs
SSize_p9c8 <- 1: num_ped
LamdaVec_p9c8 <- lamdaUnit_p9c8*SSize_p9c8
powVec_p9c8 <- as.numeric(lapply(LamdaVec_p9c8,powerCal, df = 2))
df_p9c8 <- data.frame(Nped = SSize_p9c8,
power = powVec_p9c8,
Combination = rep("power3", num_ped))
### create a new enviroment for one condition
env_p9c11 <- new.env()
load("~/R-Project/BalancedPed/Simulations/p9/p9c11/modelSmr.Rdata", envir = env_p9c11)
meanDiffLL_mtam_p9c11 <- env_p9c11$smr2$Minus2LogLikelihood - env_p9c11$smr1$Minus2LogLikelihood
lamdaUnit_p9c11 <- meanDiffLL_mtam_p9c11/env_p9c11$smr1$numObs
SSize_p9c11 <- 1: num_ped
LamdaVec_p9c11 <- lamdaUnit_p9c11*SSize_p9c11
powVec_p9c11 <- as.numeric(lapply(LamdaVec_p9c11,powerCal, df = 2))
df_p9c11 <- data.frame(Nped = SSize_p9c11,
power = powVec_p9c11,
Combination = rep("power4", num_ped))
### create a data frame for graphs
df_p9 <- rbind(df_p9c2, df_p9c5, df_p9c8, df_p9c11)
df_p9$Combination <- as.factor(df_p9$Combination)
g1 <-ggplot(data = df_p9)+ geom_line(mapping = aes(x = Nped, y = power, color= Combination), size = 1.5) +
scale_color_manual(values=my_palette[1:4],
name="Variance Combinations",
breaks=c("power1", "power2", "power3","power4"),
labels=c("a\u00B2 = .6, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .2, mt\u00B2 = .05, j\u00B2 = .05",
"a\u00B2 = .4, mt\u00B2 = .05, j\u00B2 = .05, d\u00B2 = .1")
)+
theme(panel.background = element_rect(fill = "transparent"),
panel.grid = element_line(color = "transparent"),
axis.line = element_line(size = 1, colour = "black"),
#axis.line.y = element_blank(),
axis.text = element_text( color = "black"),
#axis.text.y = element_blank(),
#axis.ticks.y = element_blank(),
text=element_text( family="Calibri",  size = 12),
legend.spacing = unit(-17,'pt'),
legend.margin = margin(t=0,b=0,unit='pt'),
legend.background = element_rect(),
legend.position=c(.8,.2))+
xlab("N of Pedigrees")+
scale_y_continuous(n.breaks = 6)+
ylab("Power (mt\u00B2+j\u00B2)")+
geom_hline(yintercept = .8, linetype = 5, size = .8, color = "grey")
# +
# annotate(geom = "text",x = 0.62, y =.92, label = "a\u00B2 = .6", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.73, y =.6, label = "a\u00B2 = .4", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .2", family="Calibri", color = "gray40",size = 3)+
# annotate(geom = "text",x = 0.9, y =.6, label = "a\u00B2 = .4, d\u00B2 = .1", family="Calibri", color = "gray40",size = 3)
g1
ggsave( "~/R-Project/BalancedPed/Graphs/Appendix/p11all.png",g1, width = 6, height = 4.5,  type = "cairo-png", dpi = 900)
rm(list = ls())
